<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¡Œé¢æç¤ºåº”ç”¨</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <style type="text/tailwindcss">
        @layer utilities {
            .content-auto {
                content-visibility: auto;
            }
            .tip-window {
                @apply absolute p-4 md:p-5 rounded-lg shadow-lg shadow-black/20 transition-all duration-300 ease-in-out cursor-pointer select-none;
            }
            .tip-text {
                @apply font-bold text-black text-base md:text-lg whitespace-nowrap;
            }
        }
    </style>
</head>
<body class="min-h-screen bg-gray-50">
    <!-- æç¤ºå¼¹çª—å®¹å™¨ -->
    <div id="tips-container"></div>

    <script>
        // åº”ç”¨çŠ¶æ€
        const appState = {
            isRunning: false,
            timer: null,
            currentTipsCount: 0,
            maxTips: 50,       // æœ€å¤§å¼¹çª—æ•°
            showInterval: 0.2,  // æ˜¾ç¤ºé—´éš”(ç§’)
            displayTime: 10000  // æ˜¾ç¤ºæ—¶é—´(æ¯«ç§’)
        };

        // DOMå…ƒç´ 
        const tipsContainer = document.getElementById('tips-container');

        // è·å–éšæœºæç¤ºè¯­
        async function getRandomTip() {
            try {
                const response = await fetch('/api/random_tip');
                const data = await response.json();
                return data;
            } catch (error) {
                console.error('è·å–æç¤ºå¤±è´¥:', error);
                // è¿”å›å¤‡ç”¨æ•°æ®
                const backupTips = [
                    "å¤šå–æ°´ï¼Œä¿æŒèº«ä½“æ°´åˆ†ğŸ’§",
                    "èµ·æ¥æ´»åŠ¨ä¸€ä¸‹ï¼Œç¼“è§£ä¹…åç–²åŠ³ğŸƒ",
                    "è®°å¾—å®šæ—¶ä¼‘æ¯çœ¼ç›ğŸ‘€",
                    "æ·±å‘¼å¸ï¼Œæ”¾æ¾èº«å¿ƒğŸ§˜",
                    "ä¿æŒè‰¯å¥½çš„åå§¿ï¼Œä¿æŠ¤é¢ˆæ¤ğŸ’º",
                    "å–æ¯èŒ¶ï¼Œä¼‘æ¯ä¸€ä¸‹â˜•",
                    "ä¼¸å±•ä¸€ä¸‹å››è‚¢ï¼Œä¿ƒè¿›è¡€æ¶²å¾ªç¯âœ¨",
                    "è®°å¾—åƒåˆé¤/æ™šé¤å“¦ğŸ½ï¸",
                    "ä¼‘æ¯ä¸€ä¸‹ï¼Œæé«˜å·¥ä½œæ•ˆç‡âš¡",
                    "çª—å¤–çœ‹çœ‹ï¼Œè°ƒèŠ‚è§†åŠ›ğŸŒ³",
                    // è€ƒç ”ç›¸å…³æç¤ºè¯­
                    "è€ƒç ”åŠ æ²¹ï¼åšæŒå°±æ˜¯èƒœåˆ©ğŸ’ª",
                    "ä»Šå¤©çš„åŠªåŠ›ï¼Œæ˜å¤©çš„æ”¶è·ğŸ¯",
                    "å¤ä¹ é—´éš™ï¼Œè®°å¾—æ”¾æ¾ä¸€ä¸‹ğŸ˜Œ",
                    "ç›¸ä¿¡è‡ªå·±ï¼Œä½ ä¸€å®šèƒ½è¡Œçš„â¤ï¸",
                    "åˆç†è§„åˆ’æ—¶é—´ï¼Œæ•ˆç‡æ›´é‡è¦â°",
                    "åˆ«å¿˜äº†ç…§é¡¾å¥½è‡ªå·±çš„èº«ä½“ï¼Œæ‰èƒ½æ›´å¥½åœ°å­¦ä¹ ğŸ¥",
                    "é”™é¢˜æœ¬å¾ˆé‡è¦ï¼ŒåŠæ—¶æ•´ç†ğŸ“",
                    "é‡åˆ°éš¾é¢˜ä¸è¦æ…Œï¼Œæ…¢æ…¢æ¥æ€»èƒ½è§£å†³ğŸ¤”",
                    "é€‚å½“è¿åŠ¨ï¼Œä¿æŒç²¾åŠ›å……æ²›ğŸƒ",
                    "è€ƒç ”è·¯ä¸Šï¼Œä½ å¹¶ä¸å­¤å•ğŸ‘¥",
                    "æ¯ä¸€æ­¥éƒ½åœ¨é è¿‘æ¢¦æƒ³ğŸ“",
                    "ä¿æŒç§¯æå¿ƒæ€ï¼Œä¸€åˆ‡éƒ½ä¼šå¥½çš„ğŸ˜Š",
                    "è®°å¾—æŒ‰æ—¶åƒé¥­ï¼Œè¡¥å……èƒ½é‡ğŸ",
                    "ç¡å‰å›é¡¾ä»Šå¤©çš„å­¦ä¹ å†…å®¹ï¼Œå·©å›ºè®°å¿†ğŸ§ ",
                    "ç´¯äº†å°±ä¼‘æ¯ï¼Œä¼‘æ¯æ˜¯ä¸ºäº†æ›´å¥½åœ°å‰è¿›ğŸ›Œ",
                    // æš–å¿ƒè¯è¯­
                    "ä»Šå¤©çš„ä½ å·²ç»å¾ˆæ£’äº†ï¼Œç»§ç»­åŠ æ²¹ğŸ’–",
                    "æ¯ä¸€å¤©éƒ½å€¼å¾—æœŸå¾…ï¼Œç›¸ä¿¡è‡ªå·±ğŸŒŸ",
                    "å°å°çš„è¿›æ­¥ä¹Ÿæ˜¯è¿›æ­¥ï¼Œä¸è¦ç€æ€¥æ…¢æ…¢æ¥ğŸŒˆ",
                    "ä½ å€¼å¾—è¢«æ¸©æŸ”å¯¹å¾…ï¼ŒåŒ…æ‹¬è¢«è‡ªå·±æ¸©æŸ”å¯¹å¾…ğŸ’•",
                    "æ— è®ºå¦‚ä½•ï¼Œæˆ‘éƒ½ç›¸ä¿¡ä½ èƒ½åšå¾—å¾ˆå¥½ğŸ’¯",
                    "ç”Ÿæ´»å¯èƒ½å¾ˆéš¾ï¼Œä½†ä½ æ›´åšå¼ºğŸ’ª",
                    "åˆ«å¿˜äº†ç»™è‡ªå·±ä¸€ä¸ªå¾®ç¬‘ï¼Œä½ ç¬‘èµ·æ¥å¾ˆå¥½çœ‹ğŸ˜Š",
                    "æ¯ä¸€ä¸ªè®¤çœŸç”Ÿæ´»çš„äººéƒ½å€¼å¾—å°Šé‡âœ¨",
                    "ä½ å·²ç»èµ°äº†å¾ˆè¿œçš„è·¯ï¼Œä¸è¦è½»æ˜“æ”¾å¼ƒğŸ’«",
                    "ä¸–ç•Œå› ä¸ºæœ‰ä½ è€Œæ›´åŠ ç¾å¥½ğŸŒ",
                    "å¯¹è‡ªå·±å¥½ä¸€ç‚¹ï¼Œä½ å€¼å¾—æ‰€æœ‰çš„ç¾å¥½ğŸŒ¸",
                    "ç´¯äº†å°±æŠ±æŠ±è‡ªå·±ï¼Œæ˜å¤©ä¼šæ›´å¥½çš„ğŸŒŸ",
                    "ä½ å¾ˆé‡è¦ï¼Œä¸è¦å¿˜è®°è¿™ä¸€ç‚¹â¤ï¸",
                    "æ…¢æ…¢æ¥ï¼Œå±äºä½ çš„æ—¶å…‰ä¸ä¼šç¼ºå¸­â³",
                    "ä»Šå¤©ä¹Ÿè¦å¥½å¥½ç…§é¡¾è‡ªå·±å“¦ğŸ’"
                ];
                const backupColors = [
                    '#FF9AA2', '#FFB7B2', '#FFDAC1', '#E2F0CB', '#B5EAD7',
                    '#C7CEEA', '#E0BBE4', '#95DED9', '#FEC8D8', '#FDCBF1',
                    '#FFAFCC', '#A2D2FF', '#BDE0FE', '#CDB4DB', '#FFC8DD'
                ];
                return {
                    tip: backupTips[Math.floor(Math.random() * backupTips.length)],
                    color: backupColors[Math.floor(Math.random() * backupColors.length)]
                };
            }
        }

        // åˆ›å»ºæç¤ºçª—å£
        async function createTipWindow() {
            if (appState.currentTipsCount >= appState.maxTips) {
                console.log(`å·²è¾¾åˆ°æœ€å¤§å¼¹çª—æ•°é‡ ${appState.maxTips}`);
                stopTips();
                return;
            }

            // è·å–éšæœºæç¤ºè¯­
            const tipData = await getRandomTip();
            const tipText = tipData.tip;
            const bgColor = tipData.color;

            // åˆ›å»ºå¼¹çª—å…ƒç´ 
            const tipWindow = document.createElement('div');
            tipWindow.className = 'tip-window';
            tipWindow.style.backgroundColor = bgColor;
            tipWindow.style.zIndex = 10 + appState.currentTipsCount;

            // è®¾ç½®æç¤ºæ–‡æœ¬
            const tipTextEl = document.createElement('div');
            tipTextEl.className = 'tip-text';
            tipTextEl.textContent = tipText;
            tipWindow.appendChild(tipTextEl);

            // æ·»åŠ åˆ°å®¹å™¨
            tipsContainer.appendChild(tipWindow);
            appState.currentTipsCount++;

            // è·å–å±å¹•å°ºå¯¸å’Œå¼¹çª—å°ºå¯¸
            const screenWidth = window.innerWidth;
            const screenHeight = window.innerHeight;
            const windowWidth = tipWindow.offsetWidth;
            const windowHeight = tipWindow.offsetHeight;

            // è®¾ç½®éšæœºä½ç½®
            const x = Math.floor(Math.random() * (screenWidth - windowWidth));
            const y = Math.floor(Math.random() * (screenHeight - windowHeight));

            // åº”ç”¨ä½ç½®
            tipWindow.style.left = `${x}px`;
            tipWindow.style.top = `${y}px`;

            // æ·»åŠ å…¥åœºåŠ¨ç”»
            tipWindow.style.opacity = '0';
            tipWindow.style.transform = 'scale(0.9)';
            setTimeout(() => {
                tipWindow.style.opacity = '1';
                tipWindow.style.transform = 'scale(1)';
            }, 10);

            // æ·»åŠ æ‚¬åœæ•ˆæœ
            tipWindow.addEventListener('mouseenter', () => {
                tipWindow.style.transform = 'scale(1.05)';
                tipWindow.style.boxShadow = '0 10px 25px -5px rgba(0, 0, 0, 0.3)';
            });

            tipWindow.addEventListener('mouseleave', () => {
                tipWindow.style.transform = 'scale(1)';
                tipWindow.style.boxShadow = '0 4px 6px -1px rgba(0, 0, 0, 0.2)';
            });

            // ç‚¹å‡»å…³é—­
            tipWindow.addEventListener('click', () => {
                closeTipWindow(tipWindow);
            });

            // è‡ªåŠ¨å…³é—­
            setTimeout(() => {
                closeTipWindow(tipWindow);
            }, appState.displayTime);
        }

        // å…³é—­æç¤ºçª—å£
        function closeTipWindow(tipWindow) {
            tipWindow.style.opacity = '0';
            tipWindow.style.transform = 'scale(0.9)';
            
            setTimeout(() => {
                if (tipWindow.parentNode === tipsContainer) {
                    tipsContainer.removeChild(tipWindow);
                    appState.currentTipsCount = Math.max(0, appState.currentTipsCount - 1);
                }
            }, 300);
        }

        // å¼€å§‹æ˜¾ç¤ºæç¤º
        function startTips() {
            if (appState.isRunning) return;
            
            appState.isRunning = true;
            
            // ç«‹å³æ˜¾ç¤ºä¸€ä¸ªæç¤º
            createTipWindow();
            
            // è®¾ç½®å®šæ—¶å™¨
            appState.timer = setInterval(() => {
                if (appState.currentTipsCount < appState.maxTips && appState.isRunning) {
                    createTipWindow();
                }
                // ç§»é™¤äº†å½“è¾¾åˆ°æœ€å¤§å¼¹çª—æ•°æ—¶åœæ­¢çš„é€»è¾‘ï¼Œè®©åº”ç”¨æŒç»­è¿è¡Œ
            }, appState.showInterval * 1000);
        }

        // åœæ­¢æ˜¾ç¤ºæç¤º
        function stopTips() {
            if (!appState.isRunning) return;
            
            appState.isRunning = false;
            if (appState.timer) {
                clearInterval(appState.timer);
                appState.timer = null;
            }
        }

        // æ¸…é™¤æ‰€æœ‰æç¤º
        function clearAllTips() {
            const tipWindows = document.querySelectorAll('.tip-window');
            tipWindows.forEach(window => {
                closeTipWindow(window);
            });
            
            appState.currentTipsCount = 0;
        }

        // é”®ç›˜å¿«æ·é”®
        document.addEventListener('keydown', (e) => {
            // Escape æ¸…é™¤æ‰€æœ‰
            if (e.key === 'Escape') {
                clearAllTips();
            }
        });

        // çª—å£å¤§å°æ”¹å˜æ—¶ï¼Œè°ƒæ•´å¼¹çª—ä½ç½®
        window.addEventListener('resize', () => {
            const tipWindows = document.querySelectorAll('.tip-window');
            const screenWidth = window.innerWidth;
            const screenHeight = window.innerHeight;
            
            tipWindows.forEach(window => {
                const windowWidth = window.offsetWidth;
                const windowHeight = window.offsetHeight;
                
                let x = parseInt(window.style.left);
                let y = parseInt(window.style.top);
                
                // ç¡®ä¿å¼¹çª—ä¸è¶…å‡ºå±å¹•
                x = Math.min(x, screenWidth - windowWidth);
                y = Math.min(y, screenHeight - windowHeight);
                x = Math.max(x, 0);
                y = Math.max(y, 0);
                
                window.style.left = `${x}px`;
                window.style.top = `${y}px`;
            });
        });

        // é¡µé¢åŠ è½½å®Œæˆåè‡ªåŠ¨å¼€å§‹
        window.addEventListener('load', () => {
            setTimeout(() => {
                startTips();
            }, 1000);
        });
    </script>
</body>
</html>